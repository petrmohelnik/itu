package com.example.todo;

import java.util.*;
import java.io.*;

public class Tree {
	protected ArrayList<Node> children;
	protected Node activeNode;
	protected int lastID;
	
	public Tree()
	{
		children = new ArrayList<Node>(0);
		activeNode = null;
		lastID = 0;
	}
	
	public void setActiveNode(Node node)
	{
		activeNode = node;
	}
	
	public void addChild()
	{
		Node child = new Node(activeNode, ++lastID);
		activeNode.addChild(child);
	}
	
	public ArrayList<Node> getActiveChildren()
	{
		return activeNode.getChildren();
	}
	
	public ArrayList<Node> getRootChildren()
	{
		return children;
	}
	
	public Node findById(int id, Node node, boolean root)
	{
		Iterator<Node> itr;
		ArrayList<Node> list = new ArrayList<Node>(0);
		getAllNodes(list, null, false);
		itr = list.iterator();
		
		while(itr.hasNext())
		{
			Node returnNode = itr.next();
			if(returnNode.getID() == id)
				return returnNode;				
		}
		return null;
	}
	
	public void getAllNodes(ArrayList<Node> list, Node node, boolean root)
	{		
		Iterator<Node> itr;
		if(root)
		{
			itr = children.iterator();
		}
		else
		{
			list.add(node);
			itr = node.getChildren().iterator();
		}
		
		while(itr.hasNext())
		{
			getAllNodes(list, itr.next(), false);	
		}
		return;
	}
	
	public boolean save()
	{
		File f = new File("save");
		Iterator<Node> itr;
		ArrayList<Node> list = new ArrayList<Node>(0);
		getAllNodes(list, null, false);
		itr = list.iterator();
		
		if(f.exists())
		{
			try
			{
				f.delete();
				f.createNewFile();
			} catch(Exception e) {
				return false;
			}
		}
		
		try
		{
			BufferedWriter bw = new BufferedWriter(new FileWriter(f, true));
			
		} catch(Exception e) {
			return false;
		}
		return true;
	}
	
	public boolean load()
	{
		
		return true;
	}

}
